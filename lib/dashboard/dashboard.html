
<!doctype html>
<html lang="en">
    <!-- cspell: words buildx, containerd, dpkg, IRSSI, keyrings, lydell, nmap, winget -->
<head>
<meta charset="utf-8"/>
<title>Server Management Dashboard</title>
<meta content="text/html;charset=UTF-8" http-equiv="Content-Type"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="noindex, nofollow" name="robots"/>
<meta content="#fff" name="theme-color"/>
<meta content="Global" name="distribution"/>
<meta content="en" http-equiv="Content-Language"/>
<meta content="blendTrans(Duration=0)" http-equiv="Page-Enter"/>
<meta content="blendTrans(Duration=0)" http-equiv="Page-Exit"/>
<meta content="text/css" http-equiv="content-style-type"/>
<meta content="application/javascript" http-equiv="content-script-type"/>
<meta content="#bbbbff" name="msapplication-TileColor"/>
<link href="/styles.css" media="all" rel="stylesheet" type="text/css"/>
<link href="node_modules/@xterm/xterm/css/xterm.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo="/>
</head>
<body id="dashboard">
    <h1>Server Management Dashboard</h1>
    <p id="connection-status" class="connection-offline">Dashboard Connection: <strong>Offline</strong></p>
    <nav><ul>
        <li><button class="nav-focus" data-section="servers">Servers</button></li><li><button data-section="compose">Docker Compose</button></li><li><button data-section="logs">Logs</button></li><li><button data-section="terminal">Terminal</button></li><li><button data-section="ports">Port Summary</button></li><li><button data-section="sockets">Socket Summary</button></li><li><button data-section="help">Help</button></li>
    </ul></nav>
    <main>
        <div id="help">
            <h2>Help</h2>
            <p class="tab-description">Helpful information about this application.</p>
            <div class="section">
                <h3>Conventions</h3>
                <div class="section">
                    <h4>General</h4>
                    <p>From the command line build the application code with <code>npm run build</code> and execute the application with <code>npm run server</code></p>
                    <p>By default the application assigns random ports for the dashboard. I recommend changing these to a port of your preference, such as 3000.  Then the dashboard can be accessed by http://localhost:3000.</p>
                    <p>If extending the application code checks can be performed using <code>npm run tsc</code> and <code>npm run lint</code></p>
                </div>
                <div class="section">
                    <h4>Servers</h4>
                    <h5>Proxies</h5>
                    <p>The servers feature fully capable, though optional, support for proxies. The proxy support is divided between redirection to resources outside the given server and resources within the given server.  See the 'Definitions of Server Object Properties' on the Servers tab for more information.</p>
                    <p>The servers also feature full support for WebSockets and partial support for HTTP.  HTTP is served over WebSockets which allows both protocols to coexist on the same port. All HTTP and WebSocket traffic receives full and equivalent proxy support.</p>
                    <h5>HTTP Methods</h5>
                    <p>HTTP methods <em>DELETE</em>, <em>POST</em>, and <em>PUT</em> are supported by this application but are not handled by this application. If these HTTP methods are to be used a given server must specify a file system path to corresponding libraries executed as child processes. Simply populate the respective properties on a new server's configuration object.</p>
                    <h5>Custom WebSocket Message Handling</h5>
                    <p>Custom WebSocket messaging handling is supported by supplying a custom function to library <em>/lib/transmit/messageHandler.ts</em>. Simply add a new property to the library object where the key name is the same as the name of the respective server and then rebuild the application.  For example:
<code>const message_handler:transmit_socket_messageHandler = {
    default: function transmit_messageHandler(bufferData:Buffer):void {
        // default message handling
    },
    "my_server_name": function (data:Buffer) {
        // custom message handling
    }
}</code></p>
                    <h5>Deletion</h5>
                    <p>Deleting a server will remove the associate file system tree. <strong>Back up files you may wish to preserver before deleting a server.</strong></p>
                </div>
                <div class="section">
                    <h4>Logs</h4>
                    <p>Logging is fully customizable.  Simply call the <em>lib/utilities/log.ts</em> passing an object matching interface <em>config_log</em>. The front-end currently does not display configuration details and error objects, but that support is there awaiting display support from the front-end.</p>
                </div>
                <div class="section">
                    <h4>Terminal</h4>
                    <p>The terminal makes use of NPM modules <em>@xterm/xterm</em> and <em>@lydell/node-pty</em>. These packages expose a shell to the browser front-end with full support for SSH, VIM, IRSSI, and more. The default supported shells are PowerShell in Windows and /bin/sh elsewhere. To customize that to a different shell, such as Bash, simply modify the appropriate one line of code at <em>/lib/services/terminal.ts</em> and then rebuild the application.</p>
                    <p>Please see this guide for <a href="https://gist.github.com/fnky/458719343aabd01cfb17a3a4f7296797">ANSI Escape Codes</a> to extend and modify output to the terminal.</p>
                </div>
            </div>
            <div class="section">
                <h3>Dependencies</h3>
                <h4>NMap</h4>
                <p>NMap is the port scanner used to generate the list of ports consumed by the local machine but not related to this application instance.</p>
                <ul>
                    <li><p>Windows: <a href="https://nmap.org/download.html">download the binary</a> or install command line <code>winget install -e --id Insecure.Nmap</code> Be sure to install for all users, not for administrators only, otherwise it will prompt for Administrative privilege each time it runs.</p></li>
                    <li><p>Debian
<code>sudo apt-get update
apt-get upgrade
apt-get install nmap</code></p></li>
                </ul>
                <h4>Docker Compose</h4>
                <p>Docker Compose is a more convenient way to launch Docker containers by using a tiny YAML file to reference a prebuilt image and map resources from the container to the host machine.</p>
                <ul>
                    <li><p>Windows - (Administrative Terminal)
<code>winget install --id=Docker.DockerCLI -e
[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
mkdir 'C:\Program Files\Docker'
Start-BitsTransfer `
    -Source "https://github.com/docker/compose/releases/download/v2.30.1/docker-compose-windows-x86_64.exe" `
    -Destination $Env:ProgramFiles\Docker\docker-compose.exe</code></p></li>
                    <li><p>Debian
<code># Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/debian/gpg -o /etc/apt/keyrings/docker.asc
sudo chmod a+r /etc/apt/keyrings/docker.asc

# Add the repository to Apt sources:
echo "deb \
    [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] \
    https://download.docker.com/linux/debian \
    $(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
    sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</code></p></li>
                </ul>
            </div>
        </div>
        <div id="compose">
            <h2>Docker Compose</h2>
            <p class="tab-description">A list of configured Docker containers and their status. Container status refreshes every ${payload.intervals.compose} seconds.</p>
            <div class="section">
                <h3>Environmental Variables</h3>
                <p class="buttons"><button class="compose-variable-new">Edit Variables</button></p>
                <ul class="compose-variable-list"></ul>
            </div>
            <div class="section">
                <h3>Containers</h3>
                <p class="buttons"><button class="compose-container-new">New Container</button></p>
                <ul class="compose-container-list"></ul>
            </div>
        </div>
        <div id="logs">
            <h2>Logs</h2>
            <p class="tab-description">At this time logs are not saved outside the application, but do persist for the life of the application runtime.</p>
            <ul></ul>
        </div>
        <div id="ports">
            <h2>Port Summary</h2>
            <p class="tab-description">A list of ports in active use both from this application and outside this application. External port data refreshes every ${payload.intervals.nmap} seconds.</p>
            <div class="section">
                <h3>System Ports Outside This Application</h3>
                <table class="ports-external">
                    <thead><tr>
                        <th>Port</th>
                        <th>Protocol</th>
                        <th>Utility</th>
                    </tr></thead>
                    <tbody></tbody>
                </table>
                <p class="updated">Last Updated: <em></em></p>
            </div>
            <div class="section">
                <h3>Internal Application Ports</h3>
                <table>
                    <thead><tr>
                        <th>Port</th>
                        <th>Protocol</th>
                        <th>Type</th>
                        <th>Container Name</th>
                        <th>Description</th>
                    </tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        <div id="servers">
            <h2>Servers</h2>
            <p class="tab-description">A list of configured HTTP/WS servers hosted by this application and their respective status.</p>
            <div class="section">
                <h3>Definitions of Server Object Properties <button class="expand">Expand</button></h3>
                <dl>
                    <dt><em>activate</em> (string)</dt>
                    <dd>Instructs the application to bring the server online automatically at application start and server creation.</dd>
                    <dt><em>block_list</em> (string array)</dt>
                    <dd>The block list contains three optional string arrays of criteria to determine if matching sockets should be instantly destroyed. At this time wildcards, CIDR notation, and ranges are not supported.</dd>
                    <dt><em>domain_local</em> (string array)</dt>
                    <dd>Sockets featuring HTTP request host names in this list will be served from this server.  Sockets featuring HTTP request host names not in this list or in the redirect_domain list will be destroyed.</dd>
                    <dt><em>encryption</em> (string)</dt>
                    <dd>Whether to create an encrypted server for HTTPS and WSS protocols, an unencrypted server for HTTP and WS protocols, or both. Accepted values are <em>both</em>, <em>open</em>, or <em>secure</em>.</dd>
                    <dt><em>http</em> (object)</dt>
                    <dd>File system paths to external utilities for handling the supported HTTP methods: <em>delete</em>, <em>post</em>, and <em>put</em>.  HTTP request bodies are passed into an environmental variable on the respective child process named 'payload'.</dd>
                    <dt><em>name</em> (string)</dt>
                    <dd>The name of this server.</dd>
                    <dt><em>ports</em> (object)</dt>
                    <dd>The ports on which the server operates.</dd>
                    <dt><em>redirect_domain</em> (object)</dt>
                    <dd>Redirects traffic to a different location, such as vanity domain that may or may not be served from the same server. Each instance uses the structure of <code>"domain": ["new domain", port_number]</code> because each server can represent 0 or more domain names. If the 'new domain' is an empty string the requested domain will be used. If the port number is not a number or 0 the current server's port number will be used.</dd>
                    <dt><em>redirect_internal</em> (object)</dt>
                    <dd>Redirects resource paths within the given server based upon the hostname in the HTTP request header. This is useful for dynamic or vanity endpoints on a given server. Each instance uses the structure of <code>"domain": {"resource location": "new location"}</code> because each server can represent 0 or more domain names.</dd>
                    <dt><em>temporary</em> (boolean)</dt>
                    <dd>Providing property <em>temporary</em> with value <em>true</em> will create a server that only accepts a first successful HTTP or WebSocket connection.  All other connections will be ignored and the server will automatically remove itself once that connection completes.</dd>
                </dl>
            </div>
            <div class="section">
                <h3>Server List</h3>
                <p class="buttons"><button class="server-new">Create Server</button></p>
                <ul class="server-list"></ul>
            </div>
        </div>
        <div id="sockets">
            <h2>Socket Summary</h2>
            <p class="tab-description">A list of connected sockets. Sockets not of 'type' http are WebSocket connections. Proxy identifies the id of the paired socket or null if not piped to another socket.</p>
            <table>
                <thead><tr>
                    <th>Server</th>
                    <th>ID</th>
                    <th>Type Descriptor</th>
                    <th>Role</th>
                    <th>Proxy</th>
                    <th>Local Server IP</th>
                    <th>Local Server Port</th>
                    <th>Remote IP</th>
                    <th>Remote Port</th>
                </tr></thead>
                <tbody></tbody>
            </table>
        </div>
        <div id="terminal">
            <h2>Terminal</h2>
            <p class="tab-description">A command terminal to interact with the local operating system. Expect this terminal to mirror the operating system terminal exactly.</p>
            <div class="terminal-output"></div>
        </div>
    </main>
<script src="node_modules/@xterm/xterm/lib/xterm.js"></script><script type="application/javascript">replace_javascript</script></body></html>